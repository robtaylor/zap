; Standard ZapBasic header file
; If this one changes then they all have to be recompiled!
; $Id: ZapTWHdr,fff,v 1.1 2003-02-06 14:56:17 christian Exp $

 GBLS |zap$|
 GBLS |zapdir$|
|zap$| SETS "Zap"			; Zap or ZapX assembley
|zapdir$| SETS "<":CC:|zap$|:CC:"$Dir>" ; Application directory

ENUM			* &48480	; base error number

; get headers - some of which use the above variables

 GET <ZapSource$Dir>.h.System
 GET <ZapSource$Dir>.h.ZapLibrary
 GET <ZapSource$Dir>.h.Macros
 GET <ZapSource$Dir>.h.ZapConsts
 GET h.ZapTWVars

; syslogging macro

		GBLA	DebugCount
		GBLS	DC
DebugCount	SETA	0
DC		SETS	"log$DebugCount"

		MACRO
$la		DEBUGF	$t,$p
$la
		STMFD	R13!,{R0-R3,R8-R12,R14}
		ADRL	R0,zap
		ADR	R1,text$DC
		MOV	R2,#$p
		MOV	R3,R13
		SWI	XSysLog_LogFormatted
		B	jump$DC
text$DC		=	"$t",0
		ALIGN
jump$DC		LDMFD	R13!,{R0-R3,R8-R12,R14}

DebugCount	SETA	DebugCount+1
DC		SETS	"log$DebugCount"
		MEND


; load options word (uses R11 workspave not R12)

	MACRO
$la	FNLDR $a,$b,$cc
$la	LDR$cc $a,[R11,#$b]
	MEND

; save options word

	MACRO
$la	FNSTR $a,$b,$cc
$la	STR$cc $a,[R11,#$b]
	MEND


; default area assignment

 AREA |Assembler|,READONLY,CODE

 END
