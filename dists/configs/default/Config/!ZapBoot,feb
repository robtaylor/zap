| !ZapBoot - executed when Zap is first seen by the filer

| Make Zap pirate previously claimed filetypes
| Obey ZapCode:Config.KillEditor

| Setup
Set Alias$ZapSet Set Alias$Zap%%0Type IfVarSet %%1Type_%%%%0 Then Else Set %%1Type_%%%%0 %%*2

| Claim file type(s) only if not yet claimed
ZapSet Run Alias$@Run Run ZapCode:ZapRunFile |%|%|*0

ZapRunType FFF

Unset Alias$ZapRunType

| Claim external edits only if not yet claimed
ZapSet Edit Alias$@Edit Run <Zap$Dir>.!Run

ZapEditType FFF

Unset Alias$ZapEditType

| Claim linked and embedded objects only if not yet claimed
ZapSet OLE OLEServer$ -N Zap -R /<Zap$Dir>

ZapOLEType FFD
ZapOLEType FFF

Unset Alias$ZapOLEType

Unset Alias$ZapSet